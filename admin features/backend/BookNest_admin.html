<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BookNest Admin (Beginner Version)</title>

  <!-- LIBRARIES -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root{ --brand:#c5864a; }
    body{ background:#111; color:#eaeaea; }
    .navbar, .card{ background:#1a1a1a; border:1px solid #2a2a2a; }
    .btn-brand{ background:var(--brand); border-color:var(--brand); color:#111; }
    .btn-outline-brand{ border-color:var(--brand); color:var(--brand); }
    .btn-outline-brand:hover{ background:var(--brand); color:#111; }
    .pill{ background:rgba(197,134,74,.15); color:var(--brand); border:1px solid rgba(197,134,74,.35); }
    .cover{ width:40px; height:60px; object-fit:cover; border-radius:.25rem; }
    .section{ display:none; }
    .section.active{ display:block; }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark mb-3">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <i class="bi bi-book-half me-2 text-warning"></i> BookNest Admin
      </a>
      <ul class="navbar-nav ms-auto" id="topNav">
        <li class="nav-item"><a class="nav-link active" data-target="books" href="#">Books</a></li>
        <li class="nav-item"><a class="nav-link" data-target="reviews" href="#">Reviews</a></li>
        <li class="nav-item"><a class="nav-link" data-target="users" href="#">Users</a></li>
      </ul>
    </div>
  </nav>

  <div class="container">

    <!-- BOOKS SECTION -->
    <section id="books" class="section active">
      <div class="d-flex align-items-center gap-2 mb-2">
        <h4 class="mb-0">Books</h4>
        <span class="badge pill" id="booksCount">0</span>
        <div class="ms-auto d-flex gap-2">
          <input id="bookSearch" class="form-control" placeholder="Search by title/author/subject" style="min-width:300px">
          <select id="categoryFilter" class="form-select" style="width:200px"></select>
          <button class="btn btn-brand" data-bs-toggle="modal" data-bs-target="#bookModal"><i class="bi bi-plus-circle"></i> Add</button>
        </div>
      </div>

      <div class="card">
        <div class="table-responsive">
          <table class="table align-middle table-hover mb-0" id="booksTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Book</th>
                <th>Author</th>
                <th>Subject</th>
                <th>Year</th>
                <th>ISBN</th>
                <th style="width:140px">Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- REVIEWS SECTION -->
    <section id="reviews" class="section">
      <div class="d-flex align-items-center gap-2 mb-2">
        <h4 class="mb-0">Reviews</h4>
        <span class="badge pill" id="reviewsCount">0</span>
        <div class="ms-auto" style="max-width:220px">
          <select id="reviewStatus" class="form-select">
            <option value="all">All</option>
            <option value="pending">Pending</option>
            <option value="approved">Approved</option>
            <option value="rejected">Rejected</option>
          </select>
        </div>
      </div>

      <div class="card">
        <div class="table-responsive">
          <table class="table align-middle table-hover mb-0" id="reviewsTable">
            <thead>
              <tr>
                <th>Book</th><th>User</th><th>Rating</th><th>Review</th><th>Status</th><th style="width:170px">Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- USERS SECTION -->
    <section id="users" class="section">
      <div class="d-flex align-items-center gap-2 mb-2">
        <h4 class="mb-0">Users</h4>
        <span class="badge pill" id="usersCount">0</span>
        <input id="userSearch" class="form-control ms-auto" placeholder="Search name/email" style="max-width:320px">
      </div>

      <div class="card">
        <div class="table-responsive">
          <table class="table align-middle table-hover mb-0" id="usersTable">
            <thead>
              <tr>
                <th></th><th>Name</th><th>Email</th><th>Status</th><th>Joined</th><th style="width:200px">Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

  </div>

  <!-- BOOK MODAL -->
  <div class="modal fade" id="bookModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <form class="modal-content" id="bookForm">
        <div class="modal-header">
          <h5 class="modal-title" id="bookModalTitle">Add Book</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <input type="hidden" id="bookId">

          <div class="mb-2">
            <label class="form-label">Title</label>
            <input id="bookTitle" class="form-control" required>
          </div>

          <div class="mb-2">
            <label class="form-label">Author</label>
            <input id="bookAuthor" class="form-control" required>
          </div>

          <div class="mb-2">
            <label class="form-label">Category</label>
            <input id="bookCategory" class="form-control" required>
          </div>

          <div class="mb-2">
            <label class="form-label">Publication Year</label>
            <input id="bookYear" type="number" min="1800" max="2100" class="form-control" required>
          </div>

          <div class="mb-2">
            <label class="form-label">ISBN</label>
            <input id="bookISBN" class="form-control" required>
          </div>

          <div class="mb-2">
            <label class="form-label">Cover URL</label>
            <input id="bookCover" class="form-control">
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-brand" type="submit">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>

    /* DATA */
    const data = {
      categories: ['Software','Self-Help','Fiction'],
      authors: ['Andy Hunt','Robert C. Martin','James Clear'],
      books: [
        {id: crypto.randomUUID(), title:'Clean Code', author:'Robert C. Martin', category:'Software', year:2008, isbn:'9780132350884', cover:'https://m.media-amazon.com/images/I/41xShlnTZTL.jpg'},
        {id: crypto.randomUUID(), title:'Atomic Habits', author:'James Clear', category:'Self-Help', year:2018, isbn:'9780735211292', cover:'https://m.media-amazon.com/images/I/51-uspgqWIL.jpg'}
      ],
      reviews: [
        {id: crypto.randomUUID(), bookTitle:'Clean Code', user:'Bilal', rating:5, text:'Great!', status:'approved'},
        {id: crypto.randomUUID(), bookTitle:'Atomic Habits', user:'Ayesha', rating:4, text:'Helpful tips', status:'pending'}
      ],
      users: [
        {id: crypto.randomUUID(), name:'Ayesha Noor', email:'ayesha@example.com', status:'verified', joined:'2024-04-12'},
        {id: crypto.randomUUID(), name:'Bilal Khan', email:'bilal@example.com', status:'verified', joined:'2023-11-03'}
      ]
    };

    const $ = s => document.querySelector(s);

    /* NAVIGATION */
    function setActive(id){
      document.querySelectorAll('.section').forEach(x=>x.classList.remove('active'));
      $('#'+id).classList.add('active');
    }

    document.querySelectorAll('#topNav .nav-link').forEach(a=>{
      a.addEventListener('click', e=>{
        e.preventDefault();
        document.querySelectorAll('#topNav .nav-link').forEach(x=>x.classList.remove('active'));
        a.classList.add('active');
        setActive(a.dataset.target);
      });
    });

    /* BOOK CONTROLS */
    function loadBookControls(){
      const catFilter = $('#categoryFilter');
      catFilter.innerHTML =
        '<option value="">All subjects</option>' +
        data.categories.map(c=>`<option>${c}</option>`).join('');
    }

    function drawBooks(){
      const q = ($('#bookSearch').value||'').toLowerCase();
      const cat = $('#categoryFilter').value;
      const tb = document.querySelector('#booksTable tbody');

      tb.innerHTML = data.books
        .filter(b =>
          (!q || [b.title,b.author,b.category].some(v=>String(v).toLowerCase().includes(q))) &&
          (!cat || b.category === cat)
        )
        .map((b,i)=>`
          <tr>
            <td>${i+1}</td>
            <td class="d-flex align-items-center gap-2"><img class="cover" src="${b.cover}" /> ${b.title}</td>
            <td>${b.author}</td>
            <td><span class="badge pill">${b.category}</span></td>
            <td>${b.year}</td>
            <td>${b.isbn}</td>
            <td>
              <button class="btn btn-sm btn-outline-brand me-1" onclick='editBook("${b.id}")'><i class="bi bi-pencil"></i></button>
              <button class="btn btn-sm btn-outline-danger" onclick='deleteBook("${b.id}")'><i class="bi bi-trash"></i></button>
            </td>
          </tr>
        `).join('');

      $('#booksCount').textContent = document.querySelectorAll('#booksTable tbody tr').length;
    }

    function clearBookForm(){
      $('#bookId').value='';
      $('#bookTitle').value='';
      $('#bookAuthor').value='';
      $('#bookCategory').value='';
      $('#bookYear').value='';
      $('#bookISBN').value='';
      $('#bookCover').value='';
      $('#bookModalTitle').textContent = 'Add Book';
    }

    function editBook(id){
      const b = data.books.find(x=>x.id===id);
      if(!b) return;

      $('#bookId').value = b.id;
      $('#bookTitle').value = b.title;
      $('#bookAuthor').value = b.author;
      $('#bookCategory').value = b.category;
      $('#bookYear').value = b.year;
      $('#bookISBN').value = b.isbn;
      $('#bookCover').value = b.cover;

      $('#bookModalTitle').textContent = 'Edit Book';
      new bootstrap.Modal('#bookModal').show();
    }

    function deleteBook(id){
      if(!confirm('Delete this book?')) return;
      const i = data.books.findIndex(x=>x.id===id);
      if(i>-1) data.books.splice(i,1);
      drawBooks();
    }

    document.getElementById('bookForm').addEventListener('submit', e=>{
      e.preventDefault();

      const id = $('#bookId').value;

      const item = {
        id: id || crypto.randomUUID(),
        title: $('#bookTitle').value.trim(),
        author: $('#bookAuthor').value.trim(),
        category: $('#bookCategory').value.trim(),
        year: Number($('#bookYear').value),
        isbn: $('#bookISBN').value.trim(),
        cover: $('#bookCover').value.trim()
      };

      if(id){
        const index = data.books.findIndex(x=>x.id===id);
        if(index>-1) data.books[index] = item;
      } else {
        data.books.push(item);
      }

      bootstrap.Modal.getInstance(document.getElementById('bookModal')).hide();
      clearBookForm();
      drawBooks();
    });

    ['bookSearch','categoryFilter'].forEach(id =>
      document.getElementById(id).addEventListener('input', drawBooks)
    );

    /* REVIEWS */
    function drawReviews(){
      const status = $('#reviewStatus').value;
      const tb = document.querySelector('#reviewsTable tbody');

      tb.innerHTML = data.reviews
        .filter(r => status==='all' || r.status===status)
        .map(r=>`
          <tr>
            <td>${r.bookTitle}</td>
            <td>${r.user}</td>
            <td>${r.rating}</td>
            <td>${r.text}</td>
            <td><span class="badge ${r.status==='approved'?'bg-success':r.status==='rejected'?'bg-danger':'bg-warning text-dark'}">${r.status}</span></td>
            <td>
              <button class="btn btn-sm btn-outline-success me-1" onclick='setReviewStatus("${r.id}","approved")'>Approve</button>
              <button class="btn btn-sm btn-outline-danger" onclick='setReviewStatus("${r.id}","rejected")'>Reject</button>
            </td>
          </tr>
        `).join('');

      $('#reviewsCount').textContent =
        document.querySelectorAll('#reviewsTable tbody tr').length;
    }

    function setReviewStatus(id,status){
      const r = data.reviews.find(x=>x.id===id);
      if(!r) return;
      r.status = status;
      drawReviews();
    }

    document.getElementById('reviewStatus').addEventListener('change', drawReviews);

    /* USERS */
    function drawUsers(){
      const q = ($('#userSearch').value || '').toLowerCase();
      const tb = document.querySelector('#usersTable tbody');

      tb.innerHTML = data.users
        .filter(u => !q || [u.name,u.email].some(v=>String(v).toLowerCase().includes(q)))
        .map(u=>`
          <tr>
            <td><i class="bi bi-person-circle"></i></td>
            <td>${u.name}</td>
            <td>${u.email}</td>
            <td>${u.status}</td>
            <td>${u.joined}</td>
            <td>
              <button class="btn btn-sm btn-outline-danger me-1" onclick='setUserStatus("${u.id}","suspended")'>Suspend</button>
              <button class="btn btn-sm btn-outline-success" onclick='setUserStatus("${u.id}","verified")'>Unsuspend</button>
            </td>
          </tr>
        `).join('');

      $('#usersCount').textContent =
        document.querySelectorAll('#usersTable tbody tr').length;
    }

    function setUserStatus(id, status){
      const u = data.users.find(x => x.id === id);
      if (!u) return;
      u.status = status;
      drawUsers();
    }

    $('#userSearch').addEventListener('input', drawUsers);

    /* START */
    loadBookControls();
    drawBooks();
    drawReviews();
    drawUsers();

    document.getElementById('bookModal').addEventListener('show.bs.modal', e=>{
      if(e.relatedTarget) clearBookForm();
    });

  </script>
</body>
</html>
